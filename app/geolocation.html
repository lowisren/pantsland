<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>PGS-Geolocation|API</title>

 <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <!-- Optional theme -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
  <!-- font awesome for icons -->
        <link href="font-awesome/css/font-awesome.min.css" rel="stylesheet">
        <!--flex slider-->
        <link href="css/flexslider.css" rel="stylesheet" type="text/css" media="screen">
        <!-- animated css  -->
        <link href="css/animate.css" rel="stylesheet" type="text/css" media="screen">
        <!--web fonts-->      
        <link href='http://fonts.googleapis.com/css?family=Lato:300,400,400italic' rel='stylesheet' type='text/css'>
        <link href='http://fonts.googleapis.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css'>

        <!--owl carousel css-->
        <link href="css/owl.carousel.css" rel="stylesheet" type="text/css" media="screen">
        <link href="css/owl.theme.css" rel="stylesheet" type="text/css" media="screen">
        <!--popups css-->
        <link href="css/magnific-popup.css" rel="stylesheet" type="text/css">

<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  <!-- Custom Styles -->
  <link rel="stylesheet" href="css/styles.css">
  <link href="css/style.css" rel="stylesheet" type="text/css" media="screen">
  <style>
       #map {
        height: 400px;
        width: 100%;
       }
	   body {
	   background-color: rgba(121,140,128,1);
	  }
    </style>  
</head>
<body>
   <!-- Collect the nav links, forms, and other content for toggling -->
  <nav class="navbar navbar-inverse">
      <div class="container-fluid">
      <div class="back-wrap" id="gamewrap">
            <a href="index.html" class="back-link" id="gamelink"><i class="fa fa-long-arrow-left"></i> back to Home</a>
        </div>
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#inverseNavbar1" aria-expanded="false"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button>
			<a class="navbar-brand" href="geolocation.html">
				<img src="img/trousers_logo.png" width="20" height="40"/>
			<h5>PANTS GEOLOCATION SERVICES</h5>
       		</a>
       	</div>
        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="inverseNavbar1">
          <ul class="nav navbar-nav navbar-right">
            <li class="active"><a href="geolocation.html">Directions<span class="sr-only">(current)</span></a></li>
            <li><a href="https://developers.google.com/maps/">Google Maps API</a></li>
            <li><a href="https://geocod.io/">Geocodio API</a></li>
            <li><a href="https://www.w3.org/TR/2016/REC-geolocation-API-20161108/">W3C Geolocation Specs</a></li>
          </ul>
        </div>
        <!-- /.navbar-collapse -->
      </div>
      <!-- /.container-fluid -->
</nav>

 <div class="container-fluid">
  <div class="row text-center">
    <div class="col-md-12 text-center">
      <div class="jumbotron" id="singletron">
        <h3>Enter Start and Destination Location to Map Directions!</h3>
      </div> 
    </div>
  </div>
  <hr>
   
   <div class="row">
		<div class="col-md-12 text-center">
			<div id="map"></div>
		</div>
   </div>
<hr>
	<div class="row">
   		<div class="text-center col-md-4">
			<h3>Enter Start Location</h3>

			<label for="starAddress">Start Address:</label>
			<input class="form-control" type="text" id="starAddress" placeholder="Ex. 123 Radiohead"><br>

			<label for="starCity">Start City/State:</label>
			<input class="form-control" type="text" id="starCity" placeholder="Ex. Raleigh NC"><br/>
			
			<h3>Enter Destination Location</h3>

			<label for="destAddress">Destination Address:</label>
			<input class="form-control" type="text" id="destAddress" placeholder="Ex. 456 Bukowski"><br/>

			<label for="destCity">Destination City/State:</label>
			<input class="form-control" type="text" id="destCity" placeholder="Ex. Brooklyn NY"><br/>
			
			<button class="btn btn-lg" id="btnDirection">Get Directions</button>
		</div>
		
		<div class="text-center col-md-4">
			<h3>Click to get your Current Location!</h3>
			<button class="btn btn-lg" id="btnLocation">Your Location</button>
			<br/>
			<h4>Longitude: <span id="currentLong"></span></h4>
			<h4>Latitude: <span id="currentLat"></span></h4>
		</div>
		
		<div class="text-center col-md-4">
			<h3>Directions from your Current Location!</h3>
			<label>Current Location:</label>
			<h4 id="currentDir">Coordinates:</h4>
			<br/>
			<h3>Enter Destination Location</h3>

			<label for="destCurrAddress">Destination Address:</label>
			<input class="form-control" type="text" id="destCurrAddress" placeholder="Ex. 456 Bukowski"><br/>

			<label for="destCurrCity">Destination City/State:</label>
			<input class="form-control" type="text" id="destCurrCity" placeholder="Ex. Brooklyn NY"><br/>
			<button class="btn btn-lg" id="btnCurrDirection">Get Directions</button>
		</div>
		
	 </div>
	 
	 <div class="row">
		<div class="text-center col-md-4">
			
		</div>	
	</div>  
  
  <hr>
  
   <div class="footer-btm">
            <ul class="footer-nav list-inline text-center">
                <li><a href="index.html">Home</a></li>
                <li><a href="index.html#about">About Lo</a></li>
                <li><a href="index.html#work">Portfolio</a></li>
                <li><a href="index.html#contact">Contact Me</a></li>
            </ul>
        </div><!--footer-btm-->
	</div>
  

<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    <!-- Custom JS for Geolocation API -->
    <script>
	   //Variables
		var map;
		var starAddy;
		var destAddy;
		var currentCoord;
		var starCoord;
		var destCoord;
		var apiKey = '6941a80a9b4741c9885587cb5c6759658518c4a';
		
      function initMap() {
        var ptown = {lat: 36.82, lng: -76.39};
        map = new google.maps.Map(document.getElementById('map'), {
          center: ptown,
          scrollwheel: false,
          zoom: 8
        });
    
      }

	  function getDirect(starCoord, destCoord){		  
		  var directionsDisplay = new google.maps.DirectionsRenderer({
          map: map
        });
		
        // Set destination, origin and travel mode.
        var request = {
          destination: destCoord,
          origin: starCoord,
          travelMode: 'DRIVING'
        };

        // Pass the directions request to the directions service.
        var directionsService = new google.maps.DirectionsService();
        directionsService.route(request, function(response, status) {
          if (status == 'OK') {
            // Display the route on the map.
            directionsDisplay.setDirections(response);
          }
        });
		}
		
		//Click and Post function to convert address inputs to coords to get directions
		$("#btnDirection").click(function() {
			starAddy = $("#starAddress").val() + ", " + $("#starCity").val();
			destAddy = $("#destAddress").val() + ", " + $("#destCity").val();
			$.post("https://api.geocod.io/v1/geocode?api_key=" + encodeURIComponent(apiKey), {     
				  "0" : starAddy,
				  "1" : destAddy},function(data) {
				starCoord = {
					lat: data.results[0].response.results[0].location.lat,
					lng: data.results[0].response.results[0].location.lng
				};
				destCoord = {
					lat: data.results[1].response.results[0].location.lat,
					lng: data.results[1].response.results[0].location.lng
				}
				getDirect(starCoord, destCoord);
			}); //end post function
			}); //end .click
		
		
		//current location local storage and click function
		$("#btnLocation").click(function() {
				starAddy = navigator.geolocation.getCurrentPosition(function(position) {
					localStorage.currentLat = position.coords.latitude;
					localStorage.currentLong = position.coords.longitude;
					$("#currentLat").text(position.coords.latitude);
					$("#currentLong").text(position.coords.longitude);
				});
		});

		//Retreive current location from local storage and convert input to coordinates
		$("#btnCurrDirection").click(function() {
			currentCoord = {
				lat: parseFloat(localStorage.currentLat),
				lng: parseFloat(localStorage.currentLong)
			}
			$("#currentDir").html("Longitude: " + currentCoord.lng + "<br>Latitude: " + currentCoord.lat);
			destAddy = $("#destCurrAddress").val() + ", " + $("#destCurrCity").val();
			$.getJSON("https://api.geocod.io/v1/geocode?q="+ encodeURIComponent(destAddy)+"&api_key=" + encodeURIComponent(apiKey), function(data) {
				destCoord = {
					lat: data.results[0].location.lat,
					lng: data.results[0].location.lng
				}
				getDirect(currentCoord, destCoord);
			});
		});
    </script>
	<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCJ30WV_ZTw7LnqFKsFsD5WpOUWieT5Dsg&callback=initMap">
    </script>
    <script>


    </script>

</body>
</html>
